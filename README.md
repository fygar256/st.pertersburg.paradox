# python３を使った、サンクトペテルブルグのパラドックスの独自研究

コインを表が出るまで投げ続け、投げた回数をNとすると、

2^(N-1)円もらえるとするゲームにおいて、期待値を計算すると、

無限大に発散してしまう。

W=Σk=1,∞(1/2^k・2^(k-1))=∞

これは、直感と反するので、サンクトペテルスブルグのパラドックスと呼ばれる。

一旦、コインを投げる回数の期待値Sを求め、

それから賞金の期待値（もどき）μを算出する方法(方法１)を取ってみる。…①

S=Σk=1,∞ (1/2^k)=2

S=2なので、μ=2^(S-1)=2

故に、答えは２である。

と、いうのは誤っている。（よくある間違い)



一般に、期待値において、f(g(x))=g(f(x))は成り立たないので、

一旦、コインを投げる回数の期待値を求め、

それから賞金の期待値（もどき）を算出するのは誤っている。

しかし、これのどこが間違っているのかは解らない。

意味論的には合ってるが、数学的には間違っている



ウイリアム・フェラーも標本抽出で算出したが、期待値無限大が正解である。

ゲームの回数が有限に限られるならば、期待値は遥かに小さな値に収束する

無限大の繰り込みができるかどうかは謎


方法１とn回シミュレーションを繰り返した場合の平均値を求めるプログラムを載せる。

ここではn=10000とする


###　プログラムの実行結果

$ ev.py

方法１:2.0

Hit any key

シミュレーション

回数： [3, 1, 2, 1, 1, 2, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 3, 2, 1, 2, 1, 1, 2, 1, 2, 2, 4, 3, 1, 3, 4, 5, 3, 1, 3, 3, 1, 1, 1, 1, 3, 1, 1, 1, 1, 2, 1, 1, 3, 1, 1, 3, 4, 1, 1, 5, 5, 4, 1, 1, 2, 5, 1, 1, 1, 1, 2, 1, 2, 1, 2, 3, 2, 3, 2, 2, 1, 2, 1, 1, 2, 3, 1, 1, 1, 3, 1, 10, ,長いので略,8, 1, 7, 1, 1, 1]

利得額： [4.0, 1.0, 2.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 2.0, 2.0, 8.0, 4.0, 1.0, 4.0, 8.0, 16.0, 4.0, 1.0, 4.0, 4.0, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 4.0, 1.0, 1.0, 4.0, 8.0, 1.0, 1.0, 16.0, 16.0, 8.0, 1.0, 1.0, 2.0, 16.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 4.0, 2.0, 4.0, 2.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 512.0, 長いので略 , 128.0, 1.0, 64.0, 1.0, 1.0, 1.0]

コインを投げる平均回数: 1.9905

μ(10000)=1.974132271

平均利得額: 6.5987

$ 

コインを投げる平均回数は、シミュレーションを無限回すると、中心極限定理により、

限りなく2に近づく。…②

ここで、10000回シミュレーションをしたとき、

コインを投げる平均回数は1.9905になっているので、

μ（10000回のシミュレーションにおいて）＝2^(1.9905-1)≒1.974132271で、

平均利得額6.5987とは大きな開きがある。

rの平均：(r[0]+r[1]+r[2]+r[3]+r[4]+...+r[9999])/10000=1.9905

rの平均は、(r1+r2+r2+...+rn)/nで表される。

rの平均はnを∞にしたとき、限りなく2に近づく。

回数rが全て2ならば、（∑(i=1,n){2^(2-1)})n=(∑(i=1,n）{2})n=2である。

一般に確率pで勝つゲームを勝つまでやると、平均1/p回やることになる。

この場合、確率1/2で表が出るので、平均の回数は2回。これは②と同じ意味である。


lの平均la=(l[0]+l[1]+l[2]+...+l[9999])/10000=6.5987　//シミュレーション

=（∑(i=1,n){l[i]}）/n=（∑(i=1,n){2^(r[i]-1)}）/nとする。


極限において、①の、l=μ、r=Ｓとすると、l=2^(r-1)である。

試行回数を限りなく大きくすると、rは限りなく２に近づいていき、lは限りなく無限大に近づく。ここに、間違いのポイントがある。

無限回数ゲームをやると、無限回裏が続くゲームがr[i]の中に現れるので、lが発散することがわかる。
